{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/shivam/TheMovie/src/app/api/ai-recommend/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport fs from 'fs';\nimport path from 'path';\n\nexport async function GET(request: Request) {\n    const { searchParams } = new URL(request.url);\n    const movieId = searchParams.get('movieId');\n\n    if (!movieId) {\n        return NextResponse.json({ error: 'Movie ID is required' }, { status: 400 });\n    }\n\n    try {\n        // Path to the generated artifacts\n        const jsonPath = path.join(process.cwd(), 'src/data/recommendations.json');\n\n        // Check if models exist\n        if (!fs.existsSync(jsonPath)) {\n            // Fallback for demo if model hasn't been trained yet\n            return NextResponse.json({\n                status: 'uninitialized',\n                message: 'Model not trained yet. Run python ml/train_model.py',\n                recommendations: []\n            });\n        }\n\n        const data = await fs.promises.readFile(jsonPath, 'utf-8');\n        const recommendations = JSON.parse(data);\n\n        // Look up the movie\n        const recs = recommendations[movieId];\n\n        if (!recs) {\n            // Cold start or unknown movie: return empty or fallback to popular\n            // For now, return empty array to signify \"no specific AI recs found\"\n            return NextResponse.json({ recommendations: [] });\n        }\n\n        // Return the list of TMDB IDs\n        return NextResponse.json({ recommendations: recs });\n\n    } catch (error) {\n        console.error('AI Recommendation Error:', error);\n        return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAgB;IACtC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,UAAU,aAAa,GAAG,CAAC;IAEjC,IAAI,CAAC,SAAS;QACV,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC9E;IAEA,IAAI;QACA,kCAAkC;QAClC,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;QAE1C,wBAAwB;QACxB,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,WAAW;YAC1B,qDAAqD;YACrD,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACrB,QAAQ;gBACR,SAAS;gBACT,iBAAiB,EAAE;YACvB;QACJ;QAEA,MAAM,OAAO,MAAM,wGAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC,UAAU;QAClD,MAAM,kBAAkB,KAAK,KAAK,CAAC;QAEnC,oBAAoB;QACpB,MAAM,OAAO,eAAe,CAAC,QAAQ;QAErC,IAAI,CAAC,MAAM;YACP,mEAAmE;YACnE,qEAAqE;YACrE,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,iBAAiB,EAAE;YAAC;QACnD;QAEA,8BAA8B;QAC9B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,iBAAiB;QAAK;IAErD,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACJ"}}]
}